// ADC PINS
READ BIT P2.5
WRITE BIT P2.6
INTR BIT P2.7

// LCD PINS
RS BIT P2.2
RW BIT P2.1
E BIT P2.0
	
ORG 00H
ACALL LCD_INIT
MOV P1,#0FFH
SETB INTR

BACK:CLR WRITE
     SETB WRITE
HERE:JB INTR,HERE
     CLR READ
	 ACALL DELAY
	 MOV A,P1
	 ACALL HEX_ASCII
	 
	 MOV A, #80H
	 ACALL COMMAND
	 MOV A, R7
	 ACALL DISPLAY
	 
	 MOV A, #81H
	 ACALL COMMAND
	 MOV A, R6
	 ACALL DISPLAY
	 
	 MOV A, #82H
	 ACALL COMMAND
	 MOV A, R5
	 ACALL DISPLAY
	 
	 ACALL DELAY
	 SETB READ
	 SJMP BACK

ORG 100H
DELAY:
MOV R1,#0FFH
AG:MOV R2,#01H
AG1:DJNZ R2,AG1
DJNZ R1,AG
RET

ORG 150H
LCD_INIT:
MOV A, #38H
ACALL COMMAND
MOV A, #0CH
ACALL COMMAND
MOV A, #01H
ACALL COMMAND
;MOV A, #83H
;ACALL COMMAND
;MOV A, #95H
;ACALL DISPLAY
MOV A, #83H
ACALL COMMAND
MOV A, #43H
ACALL DISPLAY
RET

ORG 200H
COMMAND:
ACALL READY
MOV P0, A
CLR RS
CLR RW
SETB E
ACALL DELAY
CLR E
RET

ORG 250H
DISPLAY:
ACALL READY
MOV P0, A
SETB RS
CLR RW
SETB E
ACALL DELAY
CLR E
RET

ORG 300H
READY:
SETB P0.7
CLR RS
SETB RW
AGAIN:CLR E
ACALL DELAY
SETB E
JB P0.7, AGAIN
RET

ORG 350H
HEX_ASCII:
MOV B, #10
DIV AB
MOV R5, B
MOV B, #10
DIV AB
MOV R6, B
MOV R7, A
ACALL DEC_ASCII
RET

ORG 400H
DEC_ASCII:
MOV A, R5
ORL A, #30H
MOV R5, A
MOV A, R6
ORL A, #30H
MOV R6, A
MOV A, R7
ORL A, #30H
MOV R7, A
RET

END
